{
  "entities": {
    "JobApplication": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "JobApplication",
      "type": "object",
      "description": "Represents a job application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the JobApplication entity."
        },
        "company": {
          "type": "string",
          "description": "The name of the company."
        },
        "role": {
          "type": "string",
          "description": "The role applied for."
        },
        "jobDescriptionLink": {
          "type": "string",
          "description": "Link to the job description.",
          "format": "uri"
        },
        "applicationDate": {
          "type": "string",
          "description": "The date the application was submitted.",
          "format": "date-time"
        },
        "location": {
          "type": "string",
          "description": "The location of the job (Remote or Country)."
        },
        "status": {
          "type": "string",
          "description": "Current stage in the application pipeline (Applied, Recruiter Call, etc.)."
        },
        "isArchived": {
          "type": "boolean",
          "description": "Indicates if the application is archived."
        }
      },
      "required": [
        "id",
        "company",
        "role",
        "applicationDate",
        "location",
        "status",
        "isArchived"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/jobApplications/{jobApplicationId}",
        "definition": {
          "entityName": "JobApplication",
          "schema": {
            "$ref": "#/backend/entities/JobApplication"
          },
          "description": "Stores job application data for each user. Ensures that only the authenticated user can access their own job applications through path-based ownership.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "jobApplicationId",
              "description": "The unique identifier of the job application."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure authorization independence, clarity, and scalability for the JobTracker Pro application. Job applications are stored under each user's document to ensure that only the authenticated user has access to their own applications. This structure inherently provides path-based ownership, simplifying security rules and eliminating the need for complex authorization logic. This approach ensures authorization independence, enabling atomic operations and easy debugging.\n\nTo support the required QAPs (Queries are not Filters), the structure avoids mixing data with different access requirements in the same collection. Job applications are strictly segregated by user, so listing operations are naturally secured by Firestore's path-based security. There is no need for filtering based on user roles or permissions within the queries themselves.\n\nThe `isArchived` flag is included within each job application document. This allows for efficient filtering of archived applications on the client-side without compromising the integrity of the main collection. This setup ensures that the application can easily distinguish between active and archived applications while maintaining data clarity and predictability."
  }
}